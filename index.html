<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' blob: data:; script-src 'self' 'unsafe-inline' 'unsafe-eval' blob:; worker-src 'self' blob:;">
    <title>Linux WASM Project</title>
    <style>
        body { background: #1a1a1a; color: white; font-family: sans-serif; text-align: center; margin: 0; padding: 20px; }
        #screen_container { border: 4px solid #333; background: black; display: inline-block; min-width: 640px; min-height: 400px; }
        canvas { display: none; }
        .status-msg { margin-top: 10px; color: #888; }
    </style>
</head>
<body>

    <h1>WebAssembly Linux Mint (Lite)</h1>
    
    <div id="screen_container">
        <div id="loader" style="padding: 50px;">Завантаження бібліотек...</div>
        <canvas></canvas>
    </div>

    <div class="status-msg">Якщо бачите чорне вікно — почекайте завантаження образу (16МБ)</div>

    <script src="libv86.js"></script>

    <script>
        window.onload = function() {
            const loader = document.getElementById("loader");

            if (typeof V86Starter === "undefined") {
                loader.innerHTML = "<b style='color:red'>Помилка: libv86.js заблоковано браузером.</b><br>Спробуйте натиснути Ctrl+F5 або відкрити в Chrome.";
                return;
            }

            loader.innerHTML = "Ініціалізація системи... зачекайте.";

            const emulator = new V86Starter({
                wasm_path: "v86.wasm",
                memory_size: 512 * 1024 * 1024,
                vga_fps: 30,
                screen_container: document.getElementById("screen_container"),
                bios: { url: "seabios.bin" },
                vga_bios: { url: "vgabios.bin" },
                cdrom: { url: "linux.iso" },
                autostart: true,
            });

            emulator.add_listener("emulator-ready", function() {
                loader.style.display = "none";
            });
        };
    </script>
</body>
</html>
